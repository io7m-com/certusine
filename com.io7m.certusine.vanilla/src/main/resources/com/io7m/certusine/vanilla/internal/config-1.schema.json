{
  "$id": "https://www.io7m.com/software/certusine/config-1.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",

  "$defs": {
    "SchemaIdentifier": {
      "type": "string",
      "const": "https://www.io7m.com/software/certusine/config-1.json"
    },

    "Parameter": {
      "type": "object",
      "properties": {
        "Name": {
          "type": "string"
        },
        "Value": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "Name",
        "Value"
      ]
    },

    "Output": {
      "type": "object",
      "properties": {
        "Type": {
          "type": "string"
        },
        "Name": {
          "type": "string"
        },
        "Parameters": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Parameter"
          }
        }
      },
      "additionalProperties": false,
      "required": [
        "Type",
        "Name",
        "Parameters"
      ]
    },

    "DNSConfigurator": {
      "type": "object",
      "properties": {
        "Type": {
          "type": "string"
        },
        "Name": {
          "type": "string"
        },
        "Parameters": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Parameter"
          }
        }
      },
      "additionalProperties": false,
      "required": [
        "Type",
        "Name",
        "Parameters"
      ]
    },

    "Account": {
      "type": "object",
      "properties": {
        "Name": {
          "type": "string"
        },
        "PublicKeyPath": {
          "type": "string"
        },
        "PrivateKeyPath": {
          "type": "string"
        },
        "AcmeURI": {
          "type": "string",
          "format": "uri"
        }
      },
      "additionalProperties": false,
      "required": [
        "Name",
        "PublicKeyPath",
        "PrivateKeyPath",
        "AcmeURI"
      ]
    },

    "Certificate": {
      "type": "object",
      "properties": {
        "Name": {
          "type": "string",
          "pattern": "[a-z0-9]([a-z0-9\\._-]*)"
        },
        "Hosts": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "PublicKeyPath": {
          "type": "string"
        },
        "PrivateKeyPath": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "Name",
        "Hosts",
        "PublicKeyPath",
        "PrivateKeyPath"
      ]
    },

    "Domain": {
      "type": "object",
      "properties": {
        "Name": {
          "type": "string"
        },
        "Account": {
          "type": "string"
        },
        "Certificates": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Certificate"
          }
        },
        "Outputs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "DNSConfigurator": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "Account",
        "Certificates",
        "DNSConfigurator",
        "Name",
        "Outputs"
      ]
    },

    "Options": {
      "type": "object",
      "properties": {
        "DNSWaitTime": {
          "type": "string"
        },
        "CertificateStore": {
          "type": "string"
        },
        "CertificateExpirationThreshold": {
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "CertificateStore"
      ]
    },

    "Configuration": {
      "type": "object",
      "properties": {
        "%Schema": {
          "$ref": "#/$defs/SchemaIdentifier"
        },
        "Accounts": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Account"
          }
        },
        "Outputs": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Output"
          }
        },
        "DNSConfigurators": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/DNSConfigurator"
          }
        },
        "Domains": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/Domain"
          }
        },
        "Options": {
          "$ref": "#/$defs/Options"
        }
      },
      "additionalProperties": false,
      "required": [
        "%Schema",
        "Outputs",
        "DNSConfigurators",
        "Domains",
        "Options"
      ]
    }
  },

  "$ref": "#/$defs/Configuration"
}
